# QoS 服务质量
	quality of service
## 一、影响网络服务的要素
1.  bandwidth : 带宽,绝对因素,端对端的最小值限制
	1. quality of service 是在给定的bandwidth情况下牺牲不重要,次要的应用流量来保证主要流量
2.  delay : 延时/延迟,固定的,一般是主动设置的为了提供后悔的机会,端对端的delay之和
3.  jitter : 抖动,变化的延迟,需要避免的(常见原因:侵略流浪,类似迅雷这种原因)
4.  lost:丢包,drop
	1. tail drop:尾丢弃,在ethernet网络中存在包的传输存在队列机制,当带宽跑慢的时候,尾部的包会丢弃,这种丢弃是无差别,无区分的需要尽力避免
5.  RED : radom early detection 随机早丢弃,在队列满之前,随机丢弃一些流量避免队列满
		队列: 
			硬件队列 : 在物理接口中存在个队列,FIFO(first in first out)
			软件队列 : 在系统中缓存
		
## 二、quality of service
QoS 的几种工作模型

1.  best effort 尽力而为（默认设定，做不到就不做了）
2.  集成服务只适用于小型网络 ~~逐渐淘汰~~（由于这种配置qos极其不灵活，所以和atm僵持竞争了很长时间，知道出现拆分服务）
![[Qos集成模式.png]]
example 是一个千兆带宽bandwidth，假设预留1m这样r2，r3，r4各段的链路带宽都大于1m所以可以预留1m，这样可以对重要的数据设置预留下来当带宽跑满了之后，重要的数据可以走预留的1m数据，**但是问题这种集成服务需要全部配置的预留相同，不能针对不同带宽做优化**而且必须要在一个管理域（可以独享也可以独占）
3.  拆分服务
![[拆分服务.png]]
简单的说就是两个不同的区域之间犹豫协议的不同,我的配置在另外的域间可能产生的效果不同
###### 区分服务框架[[区分服务]]
![[区分服务的简单流程描述.png]]首先可以根据acl/length等等进行筛选分类,或者根据速率借助令牌桶进行着色
令牌桶:
		单通单速双色
		双通单速三色
		双通双速三色
以此为基础进行打标记(二层802.1p,exp--以太网,de常用于fr),三层ipp(优先级)dscp
之后进行调节(整形,监管限速等)之后可以进行阻塞避免操作或者阻塞管理之后进入硬件

## 三、QoS的工具

1.  传统命令行，lagecy cli
	1. 简单高效，缺点大型网络人为错误多
2.  MQC module Qos Cli 模块化Qos命令
	1. traffic-classic 流分类
	2. traffic-behavior 流行为
	3. traffic-policy 流策略
	4. 制定接口方向
		1. inbound
		2. outbound
		优点：模块化可以复用
3.  厂商内置好的